# v4.12.1 Release Post-Mortem (Column Drag Text Selection Fix)

**Date**: 2026-01-09
**Duration**: ~30 minutes
**Versions Iterated**: 1 letter version (v4.11.1.a)
**Release Components**:
- readerwrangler.js v4.11.1
- APP version v4.12.1

---

## What Worked Well

### 1. **Quick Root Cause Identification**
- Compared `handleColumnDragStart` with `handleMouseDown` (for books)
- Noticed book drag had `e.preventDefault()` but column drag didn't
- **Lesson**: When debugging similar functionality, compare working vs non-working code paths

### 2. **Followed Code/Test Cycle**
- Created feature branch before making changes
- Incremented version with letter suffix before testing
- Committed before testing as per SKILL rules
- **Lesson**: Following the process prevents lost work and enables rollback

---

## Mistakes Made

### 1. **Used `git add -A` During Release**
- Accidentally committed `readerwrangler-backup-2026-01-09.json` and `style.html`
- These were untracked temp files in the working directory
- **Fix**:
  - Removed files from commit via `git rm --cached` and amend
  - Added patterns to `.gitignore` to prevent recurrence
  - Added rule to SKILL file: "NEVER use `git add -A` or `git add .`"

---

## Lessons Learned

### 1. **preventDefault() vs stopPropagation()**
- `stopPropagation()` - prevents event from bubbling up to parent elements
- `preventDefault()` - prevents browser's default behavior (like text selection during drag)
- For drag operations, typically need BOTH to prevent selection and bubbling

### 2. **Browser Text Selection During Drag**
- Browser default: mouse drag selects text
- Custom drag handlers must call `e.preventDefault()` to suppress this
- Easy to miss when copying partial patterns from other handlers

---

## AI Collaboration Insights

### Practices That Required User Prompting
- User had to remind to follow SKILL file process (feature branch, versioning)
- User caught the `git add -A` mistake and asked to identify the root cause
- User corrected version numbering (APP version 4.12.1, not 4.10.2)

### What Ground Rules Helped
- "Stop and ask" rule allowed user to catch mistakes before push
- Session Checklist kept release steps organized
- Code/Test Cycle ensured proper branching and versioning

---

## Rule Updates Made/Proposed

### Before Release - Git Add Rule
- Added: "NEVER use `git add -A` or `git add .` - Always explicitly add only the files you modified"
- Why: Prevents accidental commit of temp files, backups, and unrelated changes
- This project versions files individually, so explicit adds are appropriate

---

## Release Statistics

### Code Changes
- **Files Changed**: 5 code/config files, 1 doc file
- **Key Changes**: Single line addition (`e.preventDefault()`)

### Testing
- User tested column drag locally
- Confirmed no text selection during drag

---

## Files Changed

**Code**:
- readerwrangler.js v4.11.1 - Added `e.preventDefault()` to `handleColumnDragStart`
- readerwrangler.html - Cache-busting version update
- .gitignore - Added patterns for backup files and style.html

**Documentation**:
- README.md - APP version badge â†’ 4.12.1
- CHANGELOG.md - v4.12.1 entry
- SKILL-Development-Ground-Rules.md - Added git add rule

---

## Recommendations for Future

### 1. **Always Explicitly List Files in git add**
- Use `git add file1 file2 file3` instead of `-A` or `.`
- Review `git status` before committing to catch unexpected files

### 2. **Compare Similar Handlers When Debugging**
- When one drag handler works and another doesn't, diff them
- Look for missing event method calls (preventDefault, stopPropagation)

---

## Related Documentation

- **CHANGELOG.md**: [v4.12.1 entry](../CHANGELOG.md#4121---2026-01-09)

---

## Final Thoughts

A simple one-line fix (`e.preventDefault()`) that was straightforward to identify by comparing working and non-working code paths. The bigger lesson was about git hygiene - using `git add -A` is a lazy shortcut that caused unnecessary cleanup work. The new SKILL rule should prevent this in future releases.

**Key Takeaway**: Always explicitly specify files in `git add` commands - it takes a few extra seconds but prevents committing unintended files.
