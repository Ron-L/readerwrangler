# v4.4.0 Release Post-Mortem - Amazon Affiliate Links

**Date**: 2026-01-02
**Duration**: ~2 hours (single session)
**Versions Iterated**: 3 letter versions (v4.4.0.a through v4.4.0.c)
**Release Components**:
- readerwrangler.js v4.4.0
- index.html v1.1.0 (footer disclosure added)
- APP version v4.4.0

---

## üéØ What Worked Well

### 1. **Disclosures-First Approach**
- User requested seeing disclosures before wiring up affiliate links
- Allowed visual review of footer, Help modal, and landing page changes
- **Lesson**: For compliance-related features, implement visible elements first for review

### 2. **UX Review During Implementation**
- User caught potential confusion: "Collect Series Books" could imply purchasing after wishlist feature was added
- Also caught that "Collections" is Amazon terminology - double confusion risk
- Renamed to "Group Series Books" during same release
- **Lesson**: Adding new features can change the meaning of existing UI elements - review holistically

### 3. **Affiliate Link Scope Discussion**
- Initial plan: affiliate links only on wishlist items
- User pointed out: 24-hour cookie window means ALL Amazon links should have affiliate tag
- Simplified implementation (no conditional logic needed)
- **Lesson**: Understand business mechanics (affiliate cookies) before implementing

---

## ‚ùå Mistakes Made

### 1. **No Feature Branch Created**
- Worked directly on main branch
- Should have created `feature-affiliate-links` branch
- **Fix**: Solo developer, no harm done, but noted for future releases

### 2. **Initial Affiliate Logic Too Narrow**
- Originally planned to only add affiliate tags to wishlist book links
- Missed the 24-hour cookie opportunity on owned book links
- **Fix**: User corrected; simplified to all links get affiliate tag

---

## üìö Lessons Learned

### 1. **Amazon Affiliate 24-Hour Cookie Window**
- When user clicks any affiliate link, anything they purchase in next 24 hours earns commission
- This means even links to already-owned books have value
- Simpler implementation: `getAmazonUrl(asin)` with no conditional logic

### 2. **Terminology Conflicts After New Features**
- "Collect" can mean "gather" or "purchase/acquire"
- "Collections" is Amazon Kindle's term for organizing books
- Adding Wishlist feature created ambiguity in existing "Collect Series Books" button
- Solution: Use unambiguous verbs like "Group" for organizational actions

---

## ü§ñ AI Collaboration Insights

### Practices That Required User Prompting
- User asked "should owned books have Amazon link in modal?" - good UX question
- User corrected affiliate scope (24-hour cookie insight)
- User caught "Collect" terminology issue

### What Ground Rules Helped
- Stop-and-ask rule: asked before each code change
- Version letter increment: tracked a‚Üíb‚Üíc iterations
- Release checklist: ensured all docs updated

---

## üîÑ Rule Updates Made/Proposed

None - existing rules worked well for this release.

---

## üìä Release Statistics

### Code Changes
- **Files Changed**: 5 (readerwrangler.js, readerwrangler.html, index.html, README.md, CHANGELOG.md, TODO.md)
- **Lines Changed**: ~50 additions, ~30 deletions

### Key Changes
- Added `AMAZON_AFFILIATE_TAG` constant and `getAmazonUrl()` helper
- Updated 3 Amazon link locations to use helper
- Added 4 disclosure locations (app footer, Help modal, landing footer, button tooltip)
- Renamed "Collect Series Books" ‚Üí "Group Series Books" (4 locations)

### Testing
- Manual testing of all 9 test plan items
- All affiliate URLs verified to contain `?tag=rclewent-20`

---

## üìã Files Changed

**Code**:
- readerwrangler.js v4.4.0 - Affiliate links, disclosures, button rename
- readerwrangler.html v4.4.0 - Cache-bust version update
- index.html v1.1.0 - Landing page footer disclosure

**Documentation**:
- README.md - Version badge update
- CHANGELOG.md - v4.4.0 entry
- TODO.md - Removed completed P1 T2, renumbered remaining items

---

## üí° Recommendations for Future

### 1. **Create Feature Branches Even for Solo Development**
- Provides cleaner git history
- Allows squashing letter-versioned commits more easily
- Habit building for potential future collaboration

### 2. **Consider Business Model Implications Early**
- Affiliate link placement affects revenue potential
- Understanding mechanics (cookie duration, scope) informs implementation

---

## üìñ Related Documentation

- **CHANGELOG.md**: [v4.4.0 entry](../CHANGELOG.md)
- **TODO.md**: Removed completed Amazon Affiliate Links item

---

## Final Thoughts

Clean, focused release that adds monetization potential while maintaining user trust through proper disclosures. The UX review during implementation was valuable - catching the "Collect" terminology issue before release saved a potential v4.4.1 fix.

**Key Takeaway**: Adding new features (Wishlist) can change the perceived meaning of existing UI elements ("Collect") - always review holistically.
